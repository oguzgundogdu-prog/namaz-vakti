(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(t){if(t.ep)return;t.ep=!0;const o=e(t);fetch(t.href,o)}})();const y=document.getElementById("location-name"),j=document.getElementById("date-display"),T=document.getElementById("next-prayer-name"),E=document.getElementById("countdown"),g=document.getElementById("prayer-times-list"),P="https://api.aladhan.com/v1/timings",S=13,h={Tahajjud:"Teheccüd",Fajr:"İmsak",Sunrise:"Güneş",Dhuhr:"Öğle",Asr:"İkindi",Maghrib:"Akşam",Isha:"Yatsı"},m=["Tahajjud","Fajr","Sunrise","Dhuhr","Asr","Maghrib","Isha"];let i=null,w=null,l=null;async function $(){M();try{const r=await L(),{latitude:a,longitude:e}=r.coords;await p(a,e),await v(a,e)}catch(r){console.error("Konum hatası:",r),y.textContent="İstanbul",await p(41.0082,28.9784)}}function L(){return new Promise((r,a)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(r,a):a(new Error("Geolocation not supported"))})}async function v(r,a){try{const n=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${r}&lon=${a}&accept-language=tr`)).json();if(n&&n.address){const t=n.address.city||n.address.town||n.address.village||n.address.state||"İstanbul";y.textContent=t}}catch(e){console.error("Konum ismi alınamadı:",e)}}async function p(r,a){try{const e=Math.floor(Date.now()/1e3),n=`${P}/${e}?latitude=${r}&longitude=${a}&method=${S}`,o=await(await fetch(n)).json();if(o.code===200)i=o.data,I(),N(),D();else throw new Error("API error")}catch(e){console.error("Namaz vakitleri alınamadı:",e),g.innerHTML='<p style="text-align:center;">Veriler yüklenemedi. Lütfen tekrar deneyin.</p>'}}function I(){if(!i||!i.timings)return;const r=i.timings.Fajr,[a,e]=r.split(":").map(Number),n=new Date;n.setHours(a,e,0,0);const t=new Date(n.getTime()-3600*1e3),o=t.getHours().toString().padStart(2,"0"),s=t.getMinutes().toString().padStart(2,"0");i.timings.Tahajjud=`${o}:${s}`}function N(){if(!i)return;const r=i.timings,a=new Date;g.innerHTML=m.map(e=>{const n=r[e],[t,o]=n.split(":").map(Number),s=new Date;return s.setHours(t,o,0,0),`
      <div class="prayer-item ${s<a?"past":""}" data-prayer="${e}">
        <span class="prayer-name">${h[e]}</span>
        <span class="prayer-time">${n}</span>
      </div>
    `}).join("")}function D(){if(!i)return;const r=i.timings,a=new Date;let e=null,n=!1;for(const t of m){const o=r[t],[s,u]=o.split(":").map(Number),c=new Date;if(c.setHours(s,u,0,0),c>a){e={key:t,time:c};break}}if(!e){const t=m[0],o=r[t],[s,u]=o.split(":").map(Number),c=new Date;c.setDate(c.getDate()+1),c.setHours(s,u,0,0),e={key:t,time:c},n=!0}w=e.time,document.querySelectorAll(".prayer-item").forEach(t=>{t.dataset.prayer===e.key&&!n&&t.classList.add("active")}),l&&clearInterval(l),f(e.key,n),l=setInterval(()=>f(e.key,n),1e3)}function f(r,a){const n=w-new Date;if(n<0){D();return}const t=Math.floor(n/(1e3*60*60)),o=Math.floor(n%(1e3*60*60)/(1e3*60)),s=Math.floor(n%(1e3*60)/1e3);E.textContent=`${d(t)}:${d(o)}:${d(s)}`;const u=h[r];T.textContent=a?`${u} (Yarın)`:u}function M(){const r=new Date,a={day:"2-digit",month:"long",year:"numeric"},e=r.toLocaleDateString("tr-TR",a);j.textContent=e}function d(r){return r.toString().padStart(2,"0")}$();

(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function e(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(t){if(t.ep)return;t.ep=!0;const a=e(t);fetch(t.href,a)}})();const D=document.getElementById("location-name"),N=document.getElementById("date-display"),S=document.getElementById("next-prayer-name"),$=document.getElementById("countdown"),p=document.getElementById("prayer-times-list"),M="https://api.aladhan.com/v1/timings",A=13,j={Tahajjud:"Teheccüd",Fajr:"İmsak",Sunrise:"Güneş",Dhuhr:"Öğle",Asr:"İkindi",Maghrib:"Akşam",Isha:"Yatsı"},E=["Tahajjud","Fajr","Sunrise","Dhuhr","Asr","Maghrib","Isha"];let c=null,m=null;async function x(){H();try{const o=await C(),{latitude:n,longitude:e}=o.coords;await g(n,e),await b(n,e)}catch(o){console.error("Konum hatası:",o),D.textContent="İstanbul",await g(41.0082,28.9784)}}function C(){return new Promise((o,n)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(o,n):n(new Error("Geolocation not supported"))})}async function b(o,n){try{const r=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${o}&lon=${n}&accept-language=tr`)).json();if(r.address){const t=r.address.city||r.address.town||r.address.state||r.address.province;t&&(D.textContent=t)}}catch(e){console.error("Konum adı alınamadı:",e)}}function H(){const o={weekday:"long",year:"numeric",month:"long",day:"numeric"};N.textContent=new Date().toLocaleDateString("tr-TR",o)}async function g(o,n){try{const e=Math.floor(Date.now()/1e3),t=await(await fetch(`${M}/${e}?latitude=${o}&longitude=${n}&method=${A}`)).json();if(t.code===200)c=t.data,O(),R(),T();else throw new Error("API Error")}catch(e){console.error("Veri çekme hatası:",e),p.innerHTML='<div class="loading-spinner">Veri çekilemedi. Lütfen sayfayı yenileyin.</div>'}}function O(){if(!c||!c.timings)return;const o=c.timings.Fajr,[n,e]=o.split(":").map(Number),r=new Date;r.setHours(n,e,0,0);const t=new Date(r.getTime()-3600*1e3),a=t.getHours().toString().padStart(2,"0"),s=t.getMinutes().toString().padStart(2,"0");c.timings.Tahajjud=`${a}:${s}`}function R(){p.innerHTML="";const o=c.timings;E.forEach(n=>{const e=o[n],r=j[n],t=document.createElement("div");t.className="prayer-item",t.dataset.key=n,t.innerHTML=`
      <span class="prayer-name">${r}</span>
      <span class="prayer-time">${e}</span>
    `,p.appendChild(t)})}function T(){w(),m&&clearInterval(m),m=setInterval(w,1e3)}function w(){if(!c)return;const o=new Date,n=c.timings;let e=null,r=1/0,t="";for(const i of E){const u=n[i],[d,I]=u.split(":").map(Number),l=new Date;if(l.setHours(d,I,0,0),l>o){const h=l-o;h<r&&(r=h,e=l,t=i)}}let a=!1;if(!e){const i=n.Fajr,[u,d]=i.split(":").map(Number);e=new Date,e.setDate(e.getDate()+1),e.setHours(u,d,0,0),t="Fajr",a=!0}const s=e-new Date;if(s<0){T();return}const v=Math.floor(s/(1e3*60*60)),L=Math.floor(s%(1e3*60*60)/(1e3*60)),P=Math.floor(s%(1e3*60)/1e3);$.textContent=`${f(v)}:${f(L)}:${f(P)}`;const y=j[t];S.textContent=a?`${y} (Yarın)`:y,document.querySelectorAll(".prayer-item").forEach(i=>{i.classList.remove("active"),i.dataset.key===t&&i.classList.add("active")})}function f(o){return o.toString().padStart(2,"0")}x();

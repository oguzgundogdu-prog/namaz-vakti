(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function a(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=a(i);fetch(i.href,r)}})();const V=document.getElementById("location-name"),ue=document.getElementById("date-display"),ce=document.getElementById("next-prayer-name"),me=document.getElementById("countdown"),W=document.getElementById("prayer-times-list"),he=document.getElementById("nafile-list"),j=["/namaz-vakti/assets/scholar.jpg","/namaz-vakti/assets/scholar-1.jpg","/namaz-vakti/assets/scholar-2.jpg","/namaz-vakti/assets/scholar-3.jpg","/namaz-vakti/assets/scholar-4.jpg","/namaz-vakti/assets/scholar-5.jpg"],Z=[{text:"Namazı vaktinde cemaatle kılalım, ondan sonra tesbihinizi çekeceksiniz.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Yumurtanız burada beş kuruş, Beykoz'da yirmi beş kuruş olsa, yemin ederim Beykoz'da satarsınız. Peki namazı nasıl evde (kılar da ucuza) satarsın.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Dünya senin esirin olsun, niye sen onun esiri oluyorsun?! Sen ona bin, o sana niye biniyor?! Namazını cemaatle kıldıysan sen ona bindin. Malının zekatını verdiysen sen ona bindin.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Cemaatsiz kılınan namaz nâkıstır.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Cemaatle bir vakit namaz kılmayı kaçırsanız, kalbinize o miktar katılık gelir.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Bir zamanlar Rus hükümeti Müslümanlara: “Camilerde görev yapan imamlara maaş veriyoruz, siz ise namaz kılmaya gitmiyorsunuz, gelin namazlarınızı camide kılın! Eğer gelmezseniz camilerinizi ibadete kapatırız” diyerek ihtarda bulundu. Lakin bu ihtara da kulak verilmedi, sonunda bütün camiler kapatıldı. Mescid-i Aksâ bugün kimlerin elindedir? Yahudilerin. Neden? Çünkü orada bulunan Müslümanların büyük bir çoğunluğu Mescid-i Aksâ’ya namaza gitmiyorlardı da ondan. Ancak başka ülkelerden ziyaret maksadıyla gelen bir kaç Müslüman orada namaz kılardı, Mevlâ Teâlâ da ceza kabilinden Müslümanların elinden Mescid-i Aksâ’yı aldı. İslâm’ı hayatlarına tatbik etmekten üşenen kavim, Bosna Hersek’in belasına uğrar. Medreselerde öyle talebeler hocalar var ki sarf, nahiv, tefsir, hadis okuyor, okutuyor fakat namaz kılmıyor, bu olur mu hiç?!",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Ezan-ı şerîf Allâh (Celle Celâlühü)nün davetiyesidir. Câmiye gelince icabet olur, câmiye gelmedin, evde de kılmadın peki nasıl cenneti istiyorsun?! Medreseye hiç gelmedin! Çok güzel olan cennet, çok güzel para ister.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Dükkanı kapatmayalım ama namazları camide cemaatle kılalım.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Seve seve şeriatı yaşayalım. Şeriatın mühim meselelerindendir namazı camide cemaatle kılmak.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Gelirsiniz ver bana tarikat, sonra bırakırsınız, namaza başlar, bırakırsınız, çarşafı giyer, çıkarırsınız.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:`Şalvar giymekten utanırsınız, sakal, cübbe, çarşaf, uzun entari, bakın İslam kıyafetidir bu. Sen bunları giymekle "ben Müslüman'ım, benim sağlığımda islamiyete kimse yan bakamaz" demek istiyorsun.`,author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Çarşaflarınızı muhafaza ediyorsunuz Elhamdülillah, ama bilmiyorum entarileriniz nasıldır?",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Kadınların şerefi gizli kalmalarında ve erkeklerle görüşmemelerindedir. Kadın çalışacak diye tutturmuş, sonra aç kalırlarmış. Sen karışmasana, o Allahu Teala yarattığının rızkını verir.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Sizin çarşafınız bizim sarığımız, şalvarımız, sizi gören alacağını alıyor, birde tatlı sözlen konuşursan onunla, tamam.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Dilenci at üstünde gelse vereceksin, şüpheleniyorsan az ver, şüphelenmiyorsan çok ver.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Aklı başında olan adamın evinde televizyon olmaz.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"En büyük günah sorulursa, nedir? Kafirlere meyletmektir.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Karınca bacağı kadar olsa bile ekmek atmayın, bu bizi helak eder.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Televizyon hiç Mevla'yı hatırlatır mı? Zehir zakkum akıtıyor.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Ruh ile beden bir olmazsa bir milyon kere Allah (c.c) desen boş.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Çarşaf giymekle büyük yiğitlik yapıyorsunuz, milletin tesettüre heves etmesine sebep oluyorsunuz.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Çarşafınızı iyi muhafaza edin. Şunu yakinen bilin ki; bir çarşafı, bir sarığı bozmakla Çeçenistan'a gelen belayı bize de verebilir Cenab-ı hak.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Can vermeli çarşaftan vazgeçmemeli, ne güzel şeydir o.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Bu çarşafı giyen hanımlar, bilseler onların sayesinde neler oluyor, yatarken de giyerler. Siz ki Allah için tesettürünüzü muhafaza ettiniz O da sizi muhafaza eder.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Bir Hoca yüzbin televizyondan daha tesirlidir.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Rabıta muhabbetle olur, muhabbette ittiba ile olur. İttiba edersen seversin ve sevilirsin.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Mektubattan uzak kalındığı an feyiz kesilir.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Sarığı kabul etmeyenin Peygamberimiz (s.a.v.), Cebrail (a.s.), Allah-u Teala (c.c.)'de kabul etmiyor.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Dünya içinde herşey melundur, fakat zikrullah ile meşgul olan emri bil maruf nehy-i anil münker yapan okuyan ve okutan değildir.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Avrupa modasına uymak, namazı terk etmekten daha ağır geliyor.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Televizyon seyreden dinini sevmiyor demektir.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Bir kimse asılacağından korktuğu gibi imandan küfre döneceğinden de öyle korkacak.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Sen nefsini hak ile meşgul etmezsen, nefis seni batıl ile meşgul eder.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Bir kimse emri bil maruf yapacağım diye yola çıksa sonra siyasetten bahsetse, onun azabını kimse ölçemez.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Dünya sevgisi insanı şaraptan daha sarhoş eder ve ateşe girmeye cesaret verir.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Kalın kafalı nefse uyarsan her yerde rezilsin.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"İnsan bir nefes sağ olsa çok ilerler.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Bütün haramlar nefse dostluk, Mevla'ya (c.c.) düşmanlıktır.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Gezdiğimiz yerlerde talebe var, medrese yapacak para yok. Milyarlar gidiyor başka yerlere ama medreseye para yok. Bunların hepsi ahirette acısını çekecek.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"İlim, amel, ihlas. Üçü bir arada olsun, bunları cemet, dünyayı fethedersin.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"İnsanlar et gibi, ulemâ tuz gibidir. Tuzsuz et koktuğu gibi, ulemâdan ve onların sohbetinden mahrum kalanlar da kokar.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Ey talebeler! Sizler kurumuş toprakların yağmur yüklü bulutlarısınız. Direksiz kubbelerin direklerisiniz.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Bugünkü tahsil ölümden ötesini haber vermiyor. Buna siz nasıl yüksek tahsil dersiniz?",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Bir adam bir kişiye Kur'ân okutsa bütün dünyaya bedeldir. Bize Kur'ân okuyup okutmak ufak bir şey mi geliyor?",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Bilgisiz bir kimse savaş davuluna benzer; sesi çoktur, içi boştur.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"İki kişi iki kişiyi kıskanmaz; baba oğlunu, hoca talebesini.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"Hocaların bir âdeti var: bir âyeti okusalar veya dinleseler, söylemek için hemen cemaat gelir hatırına. Halbuki hatırına önce kendini getirmeli. Farkında değil, başkalarına iyilik edecek, kendini yakacak.",author:"Mahmud Efendi Kuddise Sirruhu"},{text:"İlmi olup da okutmayan, evlerinde boş boş oturan hoca hanımlar keşke iki talebe de olsa okutsaydım da âhirete ev hanımı vasfında gelmeseydim diyecek, bu yola hizmet etmediklerine çok pişman olacaklar.",author:"Mahmud Efendi Kuddise Sirruhu"}];function ye(){const e=Math.floor(Math.random()*j.length),t=j[e]+"?v="+new Date().getTime(),a=document.querySelector(".portrait-frame img");a&&(a.src=t,a.alt="Mahmud Efendi Hazretleri")}const fe="https://api.aladhan.com/v1/timings",X=13,ee={Tahajjud:"Teheccüd",Fajr:"İmsak",Sunrise:"Güneş",Dhuhr:"Öğle",Asr:"İkindi",Maghrib:"Akşam",Isha:"Yatsı"},I=["Fajr","Sunrise","Dhuhr","Asr","Maghrib","Isha"];let u=null,te=null,B=null,v={};async function ke(){ye(),Ee();try{const e=await ge(),{latitude:t,longitude:a}=e.coords;S={latitude:t,longitude:a},await q(t,a),await be(t,a)}catch(e){console.error("Konum hatası:",e),V.textContent="İstanbul",S={latitude:41.0082,longitude:28.9784},await q(41.0082,28.9784)}}function ge(){return new Promise((e,t)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e,t):t(new Error("Geolocation not supported"))})}async function be(e,t){try{const n=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e}&lon=${t}&accept-language=tr`)).json();if(n&&n.address){const i=n.address.city||n.address.town||n.address.village||n.address.state||"İstanbul";V.textContent=i}}catch(a){console.error("Konum ismi alınamadı:",a)}}async function q(e,t){try{const a=Math.floor(Date.now()/1e3),n=`${fe}/${a}?latitude=${e}&longitude=${t}&method=${X}`,r=await(await fetch(n)).json();if(r.code===200)u=r.data,pe(),Se(),ve(),xe(),ae();else throw new Error("API error")}catch(a){console.error("Namaz vakitleri alınamadı:",a),W.innerHTML='<p style="text-align:center;">Veriler yüklenemedi. Lütfen tekrar deneyin.</p>'}}function pe(){if(!u||!u.timings)return;const e=u.timings.Fajr,[t,a]=e.split(":").map(Number),n=new Date;n.setHours(t,a,0,0);const i=new Date(n.getTime()-3600*1e3),r=i.getHours().toString().padStart(2,"0"),s=i.getMinutes().toString().padStart(2,"0");u.timings.Tahajjud=`${r}:${s}`}function ve(){if(!u)return;const e=u.timings,t=new Date;W.innerHTML=I.map(a=>{const n=e[a],[i,r]=n.split(":").map(Number),s=new Date;return s.setHours(i,r,0,0),`
      <div class="prayer-item ${s<t?"past":""}" data-prayer="${a}">
        <span class="prayer-name">${ee[a]}</span>
        <span class="prayer-time">${n}</span>
      </div>
    `}).join("")}function ae(){if(!u)return;const e=u.timings,t=new Date;let a=null,n=!1;for(const i of I){const r=e[i],[s,d]=r.split(":").map(Number),l=new Date;if(l.setHours(s,d,0,0),l>t){a={key:i,time:l};break}}if(!a){const i=I[0],r=e[i],[s,d]=r.split(":").map(Number),l=new Date;l.setDate(l.getDate()+1),l.setHours(s,d,0,0),a={key:i,time:l},n=!0}te=a.time,document.querySelectorAll(".prayer-item").forEach(i=>{i.dataset.prayer===a.key&&!n&&i.classList.add("active")}),B&&clearInterval(B),N(a.key,n),B=setInterval(()=>N(a.key,n),1e3)}function N(e,t){const n=te-new Date;if(n<0){ae();return}const i=Math.floor(n/(1e3*60*60)),r=Math.floor(n%(1e3*60*60)/(1e3*60)),s=Math.floor(n%(1e3*60)/1e3);me.textContent=`${T(i)}:${T(r)}:${T(s)}`;const d=ee[e];ce.textContent=t?`${d} (Yarın)`:d}function Ee(){const e=new Date,t={day:"2-digit",month:"long",year:"numeric"},a=e.toLocaleDateString("tr-TR",t);ue.textContent=a}function T(e){return e.toString().padStart(2,"0")}function ze(){const e=document.querySelectorAll(".tab-btn"),t=document.querySelectorAll(".tab-content");if(!e||e.length===0){console.warn("Tab buttons not found");return}e.forEach(a=>{a.addEventListener("click",function(){const n=this.getAttribute("data-tab");e.forEach(r=>r.classList.remove("active")),t.forEach(r=>r.classList.remove("active")),this.classList.add("active");const i=document.getElementById(n+"-content");i&&i.classList.add("active")})})}function Se(){if(!u||!u.timings)return;const e=u.timings,t=O(e.Sunrise),a=new Date(t.getTime()+1200*1e3),n=new Date;n.setHours(10,30,0,0);const i=O(e.Maghrib),r=new Date(i.getTime()+900*1e3);v={israk:L(a),kusluk:L(n),evvabin:L(r)}}function O(e){const[t,a]=e.split(":").map(Number),n=new Date;return n.setHours(t,a,0,0),n}function L(e){const t=e.getHours().toString().padStart(2,"0"),a=e.getMinutes().toString().padStart(2,"0");return`${t}:${a}`}function xe(){var a;const e=[{id:"teheccud",name:"Teheccüd",time:((a=u==null?void 0:u.timings)==null?void 0:a.Tahajjud)||"--:--",description:"İmsak'tan 1 saat önce"},{id:"israk",name:"İşrak",time:v.israk,description:"Güneş doğduktan 20 dk sonra"},{id:"kusluk",name:"Kuşluk",time:v.kusluk,description:"Sabah ortası"},{id:"evvabin",name:"Evvabin",time:v.evvabin,description:"Akşam-Yatsı arası"}],t=ne();he.innerHTML=e.map(n=>{const i=t[n.id]||!1;return`
      <div class="nafile-item ${i?"completed":""}" data-prayer-id="${n.id}">
        <div class="nafile-item-info">
          <div class="nafile-name">${n.name}</div>
          <div class="nafile-time">${n.time} - ${n.description}</div>
        </div>
        <label class="nafile-checkbox">
          <input type="checkbox" id="nafile-${n.id}" name="nafile-${n.id}" ${i?"checked":""} onchange="handleNafileCheckbox('${n.id}', this.checked)">
          <span class="checkbox-custom"></span>
        </label>
      </div>
    `}).join("")}function Me(e,t){De(e,t);const a=document.querySelector(`[data-prayer-id="${e}"]`);t?a.classList.add("completed"):a.classList.remove("completed")}function De(e,t){const a=ne();a[e]=t,localStorage.setItem("nafileCheckboxes",JSON.stringify(a))}function ne(){const e=new Date().toDateString(),t=localStorage.getItem("nafileCheckboxes");return localStorage.getItem("nafileCheckboxesDate")!==e?(localStorage.setItem("nafileCheckboxesDate",e),localStorage.removeItem("nafileCheckboxes"),{}):t?JSON.parse(t):{}}window.handleNafileCheckbox=Me;let c=new Date().getMonth(),h=new Date().getFullYear(),z=null,S={latitude:41.0082,longitude:28.9784};const P=document.getElementById("settings-btn"),ie=document.getElementById("settings-sidebar"),x=document.getElementById("sidebar-overlay"),H=document.getElementById("sidebar-close-btn"),R=document.querySelectorAll(".sidebar-tab-btn"),Q=document.getElementById("prev-month-btn"),G=document.getElementById("next-month-btn"),Y=document.getElementById("current-month-display"),M=document.getElementById("calendar-tbody"),D=document.getElementById("quotes-list");function Ce(){ie.classList.add("active"),x.classList.add("active"),document.body.style.overflow="hidden"}function re(){ie.classList.remove("active"),x.classList.remove("active"),document.body.style.overflow=""}P&&P.addEventListener("click",()=>{Ce(),z||$(h,c+1),D&&D.children.length===0&&Te()});H&&H.addEventListener("click",re);x&&x.addEventListener("click",re);R.forEach(e=>{e.addEventListener("click",function(){const t=this.getAttribute("data-sidebar-tab");R.forEach(n=>n.classList.remove("active")),document.querySelectorAll(".sidebar-tab-content").forEach(n=>{n.classList.remove("active")}),this.classList.add("active");const a=document.getElementById(t+"-content");a&&a.classList.add("active")})});Q&&Q.addEventListener("click",()=>{c--,c<0&&(c=11,h--),$(h,c+1)});G&&G.addEventListener("click",()=>{c++,c>11&&(c=0,h++),$(h,c+1)});async function $(e,t){try{const a=`https://api.aladhan.com/v1/calendar/${e}/${t}?latitude=${S.latitude}&longitude=${S.longitude}&method=${X}`,i=await(await fetch(a)).json();if(i.code===200&&i.data)z=i.data,we(),Be();else throw new Error("Calendar API error")}catch(a){console.error("Aylık takvim yüklenemedi:",a),M&&(M.innerHTML='<tr><td colspan="7" style="text-align:center; padding:20px;">Takvim yüklenemedi</td></tr>')}}function f(e){return e?e.split(" ")[0]:"--:--"}function we(){if(!z||!M)return;const e=new Date,t=e.getDate(),a=e.getMonth(),n=e.getFullYear(),i=c===a&&h===n;M.innerHTML=z.map((r,s)=>{const d=r.timings,l=s+1;return`
      <tr class="${i&&l===t?"today":""}">
        <td>${l}</td>
        <td>${f(d.Fajr)}</td>
        <td>${f(d.Sunrise)}</td>
        <td>${f(d.Dhuhr)}</td>
        <td>${f(d.Asr)}</td>
        <td>${f(d.Maghrib)}</td>
        <td>${f(d.Isha)}</td>
      </tr>
    `}).join("")}function Be(){if(!Y)return;const e=["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"];Y.textContent=`${e[c]} ${h}`}function Te(){if(!D)return;const e=[...Z];for(let t=e.length-1;t>0;t--){const a=Math.floor(Math.random()*(t+1));[e[t],e[a]]=[e[a],e[t]]}D.innerHTML=e.map(t=>`
    <div class="quote-card">
      <div class="quote-content">
        <i class="fas fa-quote-left quote-icon"></i>
        <p class="quote-text">"${t.text}"</p>
        <div class="quote-author-container">
          <span class="quote-line"></span>
          <p class="quote-author">${t.author}</p>
        </div>
      </div>
      <div class="quote-actions">
        <button class="quote-action-btn copy-btn" onclick="copyQuote('${t.text.replace(/'/g,"\\'")}', '${t.author.replace(/'/g,"\\'")}')" title="Kopyala">
          <i class="fas fa-copy"></i>
        </button>
        <button class="quote-action-btn share-btn" onclick="shareQuote('${t.text.replace(/'/g,"\\'")}', '${t.author.replace(/'/g,"\\'")}')" title="Paylaş">
          <i class="fas fa-share-alt"></i>
        </button>
      </div>
    </div>
  `).join(""),setupQuoteObserver()}const m=document.getElementById("quote-modal-overlay"),F=document.getElementById("quote-modal-close"),_=document.getElementById("quote-modal-text");function Le(){return Z}function Ke(){const e=Le(),t=Math.floor(Math.random()*e.length),a=e[t];_&&(_.textContent=a.text),setTimeout(()=>{m&&m.classList.add("active")},800)}function oe(){m&&m.classList.remove("active")}F&&F.addEventListener("click",oe);m&&m.addEventListener("click",e=>{e.target===m&&oe()});ze();ke();Ke();const se="qadaPrayerData",Ie={counters:{fajr:0,dhuhr:0,asr:0,maghrib:0,isha:0},dailyGoal:2,today:{date:A(),completed:0,prayers:[]},history:[]};function A(){return new Date().toISOString().split("T")[0]}function $e(){try{const e=localStorage.getItem(se);if(e){const t=JSON.parse(e);return de(t),t}}catch(e){console.error("Error loading qada data:",e)}return{...Ie}}function k(e){try{localStorage.setItem(se,JSON.stringify(e))}catch(t){console.error("Error saving qada data:",t),alert("Veri kaydedilemedi. Tarayıcı hafızası dolu olabilir.")}}function de(e){const t=A();e.today.date!==t&&(e.today.completed>0&&(e.history.push({date:e.today.date,completed:e.today.completed,prayers:[...e.today.prayers]}),e.history.length>365&&(e.history=e.history.slice(-365))),e.today={date:t,completed:0,prayers:[]},k(e))}let o=$e();function Ae(e){o.counters[e]<9999&&(o.counters[e]++,k(o),y())}function je(e){o.counters[e]>0&&(o.counters[e]--,k(o),y())}function qe(e){const t=document.querySelector(`button[onclick="markQadaComplete('${e}')"]`);if(o.today.prayers.includes(e))o.today.prayers=o.today.prayers.filter(n=>n!==e),o.today.completed--,o.counters[e]++,t.classList.remove("completed");else if(o.counters[e]>0)o.today.prayers.push(e),o.today.completed++,o.counters[e]--,t.classList.add("completed");else{alert("Bu namazın kaza sayısı sıfır!");return}k(o),y(),C()}function Ne(){return Object.values(o.counters).reduce((e,t)=>e+t,0)}function Oe(){const e=o.history.slice(-7),t=e.reduce((i,r)=>i+r.completed,0);e.length>0&&(t/7).toFixed(1);const a=o.today.completed,n=t+a;return{total:n,average:(n/7).toFixed(1)}}function y(){["fajr","dhuhr","asr","maghrib","isha"].forEach(r=>{const s=document.getElementById(`counter-${r}`);s&&(s.textContent=o.counters[r]);const d=document.querySelector(`button[onclick="markQadaComplete('${r}')"]`);d&&(o.today.prayers.includes(r)?d.classList.add("completed"):d.classList.remove("completed"))});const t=document.getElementById("total-qada");t&&(t.textContent=Ne());const a=Oe(),n=document.getElementById("stat-7days"),i=document.getElementById("stat-average");n&&(n.textContent=a.total),i&&(i.textContent=a.average)}function C(){const e=document.getElementById("today-progress-text"),t=document.getElementById("today-progress-bar"),a=o.today.completed,n=o.dailyGoal,i=Math.min(a/n*100,100);e&&(e.textContent=`${a}/${n} kaza kılındı`),t&&(t.style.width=`${i}%`)}const E=document.getElementById("daily-goal");E&&(E.value=o.dailyGoal,E.addEventListener("change",e=>{o.dailyGoal=parseInt(e.target.value),k(o),C()}));const U=document.getElementById("export-qada-btn");U&&U.addEventListener("click",()=>{const e=JSON.stringify(o,null,2),t=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=`kaza_namazlari_${A()}.json`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a),alert("Yedek dosyası indirildi! ✅")});const J=document.getElementById("import-qada-btn"),p=document.getElementById("import-qada-file");J&&p&&(J.addEventListener("click",()=>{p.click()}),p.addEventListener("change",e=>{const t=e.target.files[0];if(!t)return;const a=new FileReader;a.onload=n=>{try{const i=JSON.parse(n.target.result);if(!i.counters||!i.dailyGoal)throw new Error("Geçersiz dosya formatı");confirm("Mevcut veriler silinecek ve yedek yüklenecek. Devam edilsin mi?")&&(o=i,de(o),k(o),E.value=o.dailyGoal,y(),C(),alert("Yedek başarıyla yüklendi! ✅"))}catch(i){console.error("Import error:",i),alert("Geçersiz yedek dosyası! ❌")}p.value=""},a.readAsText(t)}));document.querySelectorAll(".counter-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.prayer,a=e.dataset.action;a==="increment"?Ae(t):a==="decrement"&&je(t)})});document.querySelectorAll(".complete-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.prayer;qe(t)})});function Pe(){const e=o.history.slice(-7),t=o.history.slice(-30),a=e.reduce((g,w)=>g+w.completed,0),n=t.reduce((g,w)=>g+w.completed,0),i=o.today.completed,r=a+i,s=n+i,d=(r/7).toFixed(1),l=[...o.history,o.today],b=Math.max(...l.map(g=>g.completed),0);return{total7Days:r,total30Days:s,average:d,bestDay:b}}function He(){const e=Pe(),t=document.getElementById("stat-7days"),a=document.getElementById("stat-30days"),n=document.getElementById("stat-average"),i=document.getElementById("stat-best");t&&(t.textContent=e.total7Days),a&&(a.textContent=e.total30Days),n&&(n.textContent=e.average),i&&(i.textContent=e.bestDay)}let K=null;function le(){const e=document.getElementById("qadaChart");if(!e)return;const t=e.getContext("2d"),a=o.history.slice(-30),n=[],i=[];for(let r=29;r>=0;r--){const s=new Date;s.setDate(s.getDate()-r);const d=s.toISOString().split("T")[0],l=a.find(b=>b.date===d);n.push(s.getDate()),i.push(l?l.completed:0)}n.push("Bugün"),i.push(o.today.completed),K&&K.destroy(),K=new Chart(t,{type:"line",data:{labels:n,datasets:[{label:"Kılınan Kaza",data:i,borderColor:"rgb(6, 182, 212)",backgroundColor:"rgba(6, 182, 212, 0.1)",tension:.4,fill:!0,pointBackgroundColor:"rgb(6, 182, 212)",pointBorderColor:"#fff",pointBorderWidth:2,pointRadius:4,pointHoverRadius:6}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#fff",bodyColor:"#fff",padding:12,displayColors:!1,callbacks:{label:function(r){return r.parsed.y+" kaza kılındı"}}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1,color:"rgba(255, 255, 255, 0.7)",font:{size:11}},grid:{color:"rgba(255, 255, 255, 0.1)",drawBorder:!1}},x:{ticks:{color:"rgba(255, 255, 255, 0.7)",font:{size:10},maxRotation:0,autoSkip:!0,maxTicksLimit:15},grid:{display:!1,drawBorder:!1}}}}})}const Re=y;y=function(){Re(),He(),typeof Chart<"u"&&le()};y();C();setTimeout(()=>{typeof Chart<"u"&&le()},100);
